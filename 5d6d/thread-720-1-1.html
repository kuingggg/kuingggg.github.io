<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<script src="mjxset.js"></script>
<script src="mjx3/tex-svg.js"></script>


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



<meta http-equiv="x-ua-compatible" content="ie=7">

<title>[转]简单百年历bat - 其他软件 -  悠闲数学娱乐论坛  - Powered by Discuz!</title>

<meta name="description" content=" 悠闲数学娱乐论坛 @echo offcolor 3Fmode con cols=40 lines=20setlocal enabledelayedexpansionset str=日一二三四五六set sdate=%date%:Maincls&amp;amp;echo.:: 日期提取、 ... - Discuz! Board">






<link rel="stylesheet" type="text/css" href="thread.css" media="all">
</head><body id="viewthread" onkeydown="if(event.keyCode==27) return false;">
<div id="append_parent"></div><div id="ajaxwaitid"></div>
<div id="header">
<div class="wrap s_clear">
<h2><a indepth="true" href="index.html" title="悠闲数学娱乐论坛"><img src="k.png" alt="悠闲数学娱乐论坛" border="0"></a></h2>


</div>
</div>





<div id="nav">
<a indepth="true" href="index.html">悠闲数学娱乐论坛</a> » <a indepth="true" href="forum-28-1.html">其他软件</a> » [转]简单百年历bat</div>

<div id="ad_text"></div><div id="wrap" class="wrap s_clear threadfix">
    <div id="headsearch" class="headsearch">
        



        
    </div>
<div class="forumcontrol">
<table cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="modaction">
</td>
<td>
<span class="pageback"><a indepth="true" href="forum-28-1.html">返回列表</a></span>



</td>
</tr>
</tbody></table>
</div>



<div id="postlist" class="mainbox viewthread"><div id="post_3689"><table id="pid3689" summary="pid3689" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="postauthor">
<div class="postinfo">
<a target="_top" href="#" style="margin-left: 20px; font-weight: 800;">kuing</a>

</div>
<div class="popupmenu_popup userinfopanel" id="userinfo3689" style="display: none; position: absolute; margin-top: -11px;">
<div class="popavatar">
<div id="userinfo3689_ma"></div>

</div>
<div class="popuserinfo">
<p>
kuing
<em>当前在线
</em>
</p>

<dl class="s_clear"><dt>UID</dt><dd>1&nbsp;</dd><dt>帖子</dt><dd>3992&nbsp;</dd><dt>精华</dt><dd>0&nbsp;</dd><dt>积分</dt><dd>25208&nbsp;</dd><dt>威望</dt><dd>6 &nbsp;</dd><dt>阅读权限</dt><dd>200&nbsp;</dd><dt>性别</dt><dd>男&nbsp;</dd><dt>来自</dt><dd>广东广州&nbsp;</dd><dt>在线时间</dt><dd>4648 小时&nbsp;</dd><dt>注册时间</dt><dd>2011-9-25&nbsp;</dd><dt>最后登录</dt><dd>2013-6-6&nbsp;</dd></dl>
<div class="imicons">

</div>
<div id="avatarfeed"><span id="threadsortswait"></span></div>
</div>
</div>
 <a name="lastpost"></a><div id="userinfo3689_a">
<div class="avatar" style="text-align: center; margin-left: 0px; margin-right: 0px;"><a href="#" target="_top"><img src="01_avatar_middle.jpg" onerror="this.onerror=null;this.src='none.gif'"></a></div>
<p><em>管理员</em></p>
</div>
<p></p>
<dl class="profile s_clear"><dt>UID</dt><dd>1&nbsp;</dd><dt>帖子</dt><dd>3992&nbsp;</dd></dl></td>
<td class="postcontent">
<div class="postinfo">
<div class="posterinfo">
                <strong><em>1</em><sup>#</sup></strong>

<div class="authorinfo">
<img class="authicon" id="authicon3689" src="online_admin.gif" onclick="showauthor(this, 'userinfo3689')">
<em id="authorposton3689">发表于 2012-8-16 20:36</em>


                </div>
</div>
</div>
<div class="defaultpost">
<div id="ad_thread2_0"></div>        <div id="ad_thread4_0"></div>
<div class="postmessage firstpost">
<div id="threadtitle">
<h1>[转]简单百年历bat</h1>
</div>
<div class="t_msgfontfix">
                    <table style="width: 100%;" cellpadding="0" cellspacing="0">
                        <tbody><tr><td class="t_msgfont" id="postmessage_3689">
                                <div id="ad_thread3_0"></div>                                <div class="blockcode"><div id="code0"><ol><li>@echo off<br>
</li><li>color 3F<br>
</li><li>mode con cols=40 lines=20<br>
</li><li>setlocal enabledelayedexpansion<br>
</li><li>set str=日一二三四五六<br>
</li><li>set sdate=%date%<br>
</li><li><br>
</li><li>:Main<br>
</li><li>cls&amp;echo.<br>
</li><li>:: 日期提取、格式化与校验<br>
</li><li>for /f "tokens=1,2,3 delims=-/: " %%i in ("%sdate%") do (<br>
</li><li>&nbsp; &nbsp; (set sy=%%i) &amp;&amp; (set sm=%%j) &amp;&amp; (set sd=%%k)<br>
</li><li>)<br>
</li><li>if not defined sd set sd=1<br>
</li><li>if not defined sm set sm=%sy%&amp; set sy=%date:~0,4%<br>
</li><li><br>
</li><li>(set sy=0000%sy%) &amp;&amp; (set sm=00%sm%) &amp;&amp; (set sd=00%sd%)<br>
</li><li>(set sy=%sy:~-4%) &amp;&amp; (set sm=%sm:~-2%) &amp;&amp; (set sd=%sd:~-2%)<br>
</li><li>cd.<br>
</li><li>set /a y=1%sy%-10000, m=1%sm%-100, d=1%sd%-100 2&gt;nul<br>
</li><li>if errorlevel 1 goto Error<br>
</li><li>if %y% lss 100 (<br>
</li><li>&nbsp; &nbsp; if %y% lss 50 (set /a y+=2000) else (set /a y+=1900)<br>
</li><li>&nbsp; &nbsp; set sy=!y!<br>
</li><li>)<br>
</li><li>if %m% lss 13 if %d% lss 32 goto Calc<br>
</li><li><br>
</li><li>:Error<br>
</li><li>echo.错误的日期.<br>
</li><li>pause&gt;nul<br>
</li><li>set sdate=%date%<br>
</li><li>goto Main<br>
</li><li><br>
</li><li>:Calc<br>
</li><li>:: 计算每个月的天数<br>
</li><li>set days=31<br>
</li><li>for %%i in (4 6 9 11) do if %m% equ %%i set days=30<br>
</li><li>:: 计算2月份的偏差<br>
</li><li>set /a leap="^!(y%%4) &amp; ^!(^!(y%%100)) | ^!(y%%400)"<br>
</li><li>if %m% equ 2 set /a days=28+%leap%<br>
</li><li>if %m% leq 2 (set /a y-=1&amp; set /a m+=12)<br>
</li><li>:: 计算指定日期的星期数<br>
</li><li>set /a w=(d+2*m+3*(m+1)/5+y+y/4-y/100+y/400+1)%%7<br>
</li><li><br>
</li><li>echo.&nbsp;&nbsp;%sy%年%sm%月&nbsp;&nbsp;查询日:%sy%-%sm%-%sd%,星期!str:~%w%,1!<br>
</li><li>echo.<br>
</li><li>:: 生成月历<br>
</li><li>set /a wb=(w+35-d) %% 7, we=wb+days+1, day=1<br>
</li><li>echo.&nbsp; &nbsp; 日&nbsp; &nbsp;一&nbsp; &nbsp;二&nbsp; &nbsp;三&nbsp; &nbsp;四&nbsp; &nbsp;五&nbsp; &nbsp;六<br>
</li><li>echo. ━━━━━━━━━━━━━━━━━━━<br>
</li><li>set /p= &lt;nul<br>
</li><li>for /l %%i in (0,1,37) do (<br>
</li><li>&nbsp; &nbsp; set "temp=&nbsp;&nbsp;"<br>
</li><li>&nbsp; &nbsp; if %%i GTR %wb% if %%i LSS %we% (<br>
</li><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;set temp= !day!<br>
</li><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;set temp=!temp:~-2!<br>
</li><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if !d! EQU !day! set temp=★<br>
</li><li>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;set /a day+=1<br>
</li><li>&nbsp; &nbsp; )<br>
</li><li>&nbsp; &nbsp; set /p=&nbsp; &nbsp;!temp!&lt;nul<br>
</li><li>&nbsp; &nbsp; set /a "wm=(%%i+1)%%7"<br>
</li><li>&nbsp; &nbsp; if !wm! equ 0 echo.&amp;echo.&amp;set /p= &lt;nul<br>
</li><li>)<br>
</li><li>echo.<br>
</li><li>echo&nbsp;&nbsp;━━━━━━━━━━━━━━━━━━━<br>
</li><li>echo.&nbsp;&nbsp;输入日期可查询当日星期并显示当月月历<br>
</li><li>echo.<br>
</li><li>set sdate=<br>
</li><li>set /p sdate=&nbsp;&nbsp;格式如：07-02-03，[回车]退出:<br>
</li><li>if defined sdate goto Main</li></ol></div><em onclick="copycode($('code0'));">复制代码</em></div>将代码保存为 bat 运行即可，可查询 1950-01-01 至 2049-12-31 的日期。<!--++ plugin_code qcomic begin-->
<!--++ plugin_code qcomic end--></td></tr></tbody></table>
<div class="postattachlist">


<dl class="t_attachlist">
<dt>
<img src="binary.gif" class="absmiddle" alt="" border="0">
</dt>
<dt id="ftn_attach">
<p>
百年历.bat (1.78 KB)
</p>
<div class="attach_popup" id="aid334_menu" style="display: none;">
<div class="cornerlayger">

</div>
<div class="minicorner"></div>
</div>
<p>

</p>
</dt>

<dt id="ftn_url">

</dt>

<dt id="ftn_date">
2012-8-16 20:38
</dt>

<dt id="ftn_down">
下载次数:1
</dt>



</dl>
</div>
</div>

<div id="post_rate_div_3689"></div>

                                                
                <div id="relate_subject" style="margin-top: 10px; width: 99%;"></div>
                
                

</div>

</div>

<div id="ad_thread1_0"></div><div class="signatures" style="">
<table cellpadding="0" cellspacing="0">
<tbody><tr>
<td>
基本信息：kuing，GG，19880618~?，地道广州人，高中毕业，无业游民，不等式爱好者，论坛混混；<br>
现状：冇钱又冇样、冇型又冇款、冇身材又冇文采、冇学历又冇能力、冇高度冇速度冇力度兼夹冇野做！（粤语）</td>
</tr>
</tbody></table>
</div>
</td>
</tr>
<tr>
<td class="postauthor"></td>
<td class="postcontent">

        <div class="postactions">
<div class="postact s_clear">
<em>


</em>
<p>


</p>
</div>
</div>
</td>
</tr>
<tr class="threadad">
<td class="postauthor"></td>
<td class="adcontent">
</td>
</tr>
</tbody></table>
</div></div>

<div id="postlistreply" class="mainbox viewthread"><div id="post_new" style="display: none;"></div></div>




<div class="forumcontrol s_clear">
<table cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="modaction">
</td>
<td>
<span class="pageback"><a indepth="true" href="forum-28-1.html">返回列表</a></span>


</td>
</tr>
</tbody></table>
</div>



</div>






<div id="footer">
<div class="wrap s_clear">
<div id="footlink">

<p class="smalltext">
GMT+8, 2013-6-6 19:55.
</p>

</div>


	</div>
</div>

</body></html>
