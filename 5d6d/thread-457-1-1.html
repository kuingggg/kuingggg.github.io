<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<script src="mjxset.js"></script>
<script src="mjx3/tex-svg.js"></script>


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



<meta http-equiv="x-ua-compatible" content="ie=7">

<title>曲线拟合 - Mathematica -  悠闲数学娱乐论坛  - Powered by Discuz!</title>

<meta name="description" content=" 悠闲数学娱乐论坛 有下面一堆数据data = {{1979, 0.15}, {1980, 1.2}, {1981, 3.3}, {1982, 9.5}, {1983, &amp;nbsp; &amp;nbsp;19}, {1984, 30.61}, {1985, 40.29}, {1986, 42.11}, { ... - Discuz! Board">






<link rel="stylesheet" type="text/css" href="thread.css" media="all">
</head><body id="viewthread" onkeydown="if(event.keyCode==27) return false;">
<div id="append_parent"></div><div id="ajaxwaitid"></div>
<div id="header">
<div class="wrap s_clear">
<h2><a indepth="true" href="index.html" title="悠闲数学娱乐论坛"><img src="k.png" alt="悠闲数学娱乐论坛" border="0"></a></h2>


</div>
</div>





<div id="nav">
<a indepth="true" href="index.html">悠闲数学娱乐论坛</a> » <a indepth="true" href="forum-20-1.html">Mathematica</a> » 曲线拟合</div>

<div id="ad_text"></div><div id="wrap" class="wrap s_clear threadfix">
    <div id="headsearch" class="headsearch">
        



        
    </div>
<div class="forumcontrol">
<table cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="modaction">
</td>
<td>
<span class="pageback"><a indepth="true" href="forum-20-1.html">返回列表</a></span>



</td>
</tr>
</tbody></table>
</div>



<div id="postlist" class="mainbox viewthread"><div id="post_2454"><table id="pid2454" summary="pid2454" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="postauthor">
<div class="postinfo">
<a target="_top" href="#" style="margin-left: 20px; font-weight: 800;">kuing</a>

</div>
<div class="popupmenu_popup userinfopanel" id="userinfo2454" style="display: none; position: absolute; margin-top: -11px;">
<div class="popavatar">
<div id="userinfo2454_ma"></div>

</div>
<div class="popuserinfo">
<p>
kuing
<em>当前在线
</em>
</p>

<dl class="s_clear"><dt>UID</dt><dd>1&nbsp;</dd><dt>帖子</dt><dd>3992&nbsp;</dd><dt>精华</dt><dd>0&nbsp;</dd><dt>积分</dt><dd>25208&nbsp;</dd><dt>威望</dt><dd>6 &nbsp;</dd><dt>阅读权限</dt><dd>200&nbsp;</dd><dt>性别</dt><dd>男&nbsp;</dd><dt>来自</dt><dd>广东广州&nbsp;</dd><dt>在线时间</dt><dd>4648 小时&nbsp;</dd><dt>注册时间</dt><dd>2011-9-25&nbsp;</dd><dt>最后登录</dt><dd>2013-6-6&nbsp;</dd></dl>
<div class="imicons">

</div>
<div id="avatarfeed"><span id="threadsortswait"></span></div>
</div>
</div>
 <div id="userinfo2454_a">
<div class="avatar" style="text-align: center; margin-left: 0px; margin-right: 0px;"><a href="#" target="_top"><img src="01_avatar_middle.jpg" onerror="this.onerror=null;this.src='none.gif'"></a></div>
<p><em>管理员</em></p>
</div>
<p></p>
<dl class="profile s_clear"><dt>UID</dt><dd>1&nbsp;</dd><dt>帖子</dt><dd>3992&nbsp;</dd></dl></td>
<td class="postcontent">
<div class="postinfo">
<div class="posterinfo">
                <strong><em>1</em><sup>#</sup></strong>

<div class="authorinfo">
<img class="authicon" id="authicon2454" src="online_admin.gif" onclick="showauthor(this, 'userinfo2454')">
<em id="authorposton2454">发表于 2012-4-30 18:13</em>


                </div>
</div>
</div>
<div class="defaultpost">
<div id="ad_thread2_0"></div>        <div id="ad_thread4_0"></div>
<div class="postmessage firstpost">
<div id="threadtitle">
<h1>曲线拟合</h1>
</div>
<div class="t_msgfontfix">
                    <table style="width: 100%;" cellpadding="0" cellspacing="0">
                        <tbody><tr><td class="t_msgfont" id="postmessage_2454">
                                <div id="ad_thread3_0"></div>                                有下面一堆数据<br>
data = {{1979, 0.15}, {1980, 1.2}, {1981, 3.3}, {1982, 9.5}, {1983, <br>
&nbsp; &nbsp;19}, {1984, 30.61}, {1985, 40.29}, {1986, 42.11}, {1987, <br>
&nbsp; &nbsp;49.84}, {1988, 60}, {1989, 76.78}, {1990, 99.13}, {1991, <br>
&nbsp; &nbsp;153.54}, {1992, 187.8}, {1993, 248.28}, {1994, 318.74}, {1995, <br>
&nbsp; &nbsp;349.99}, {1996, 379.51}, {1997, 418.29}, {1998, 465.73}, {1999, <br>
&nbsp; &nbsp;512.71}, {2000, 576.32}, {2001, 592.53}, {2002, 607.17}, {2003, <br>
&nbsp; &nbsp;627.34}, {2004, 635.67}, {2005, 645.82}, {2006, 674.27}, {2007, <br>
&nbsp; &nbsp;699.99}, {2008, 726.21}, {2009, 753.56}, {2010, 786.17}}<br>
需要用函数曲线<br>
\[y(t) = \frac k{1 + a\cdot e^{-r\cdot t}}\]<br>
来拟合。<br>
<br>
但是直接利用 FindFit 的如下命令拟合出来却完全达不到想要的效果：<br>
data = {{1979, 0.15}, {1980, 1.2}, {1981, 3.3}, {1982, 9.5}, {1983, <br>
&nbsp; &nbsp; 19}, {1984, 30.61}, {1985, 40.29}, {1986, 42.11}, {1987, <br>
&nbsp; &nbsp; 49.84}, {1988, 60}, {1989, 76.78}, {1990, 99.13}, {1991, <br>
&nbsp; &nbsp; 153.54}, {1992, 187.8}, {1993, 248.28}, {1994, 318.74}, {1995, <br>
&nbsp; &nbsp; 349.99}, {1996, 379.51}, {1997, 418.29}, {1998, 465.73}, {1999, <br>
&nbsp; &nbsp; 512.71}, {2000, 576.32}, {2001, 592.53}, {2002, 607.17}, {2003, <br>
&nbsp; &nbsp; 627.34}, {2004, 635.67}, {2005, 645.82}, {2006, 674.27}, {2007, <br>
&nbsp; &nbsp; 699.99}, {2008, 726.21}, {2009, 753.56}, {2010, 786.17}};<br>
model = k/(1 + a*E^(-r*t))<br>
fit = FindFit[data, model, {k, a, r}, t]<br>
modelf = Function[{t}, Evaluate[model /. fit]]<br>
Plot[{modelf[t]}, {t, 1979, 2010}, Epilog -&gt; Map[Point, data]]<br>
得到的函数是 337.236/(1 + 1. E^(-1. t)) ，而作出的图在该部分几乎是直的。如图。<br>




<img src="attachments/12043018197f4cc6a0d4784506.png" onclick="zoom(this, this.src)" id="aimg_212" alt="QQ截图20120430181447.png" width="415">

<div class="t_attach">
 (7.8 KB)<br>

<div class="t_smallfont">2012-4-30 18:19</div></div>

<br>
<br>
然而，我们通过将数据平移（将每个横坐标均减去1979）后，却能得到一个很好的拟合<br>
datapy = {{0, 0.15}, {1, 1.2}, {2, 3.3}, {3, 9.5}, {4, 19}, {5, <br>
&nbsp; &nbsp; 30.61}, {6, 40.29}, {7, 42.11}, {8, 49.84}, {9, 60}, {10, <br>
&nbsp; &nbsp; 76.78}, {11, 99.13}, {12, 153.54}, {13, 187.8}, {14, 248.28}, {15,<br>
&nbsp; &nbsp;&nbsp;&nbsp;318.74}, {16, 349.99}, {17, 379.51}, {18, 418.29}, {19, <br>
&nbsp; &nbsp; 465.73}, {20, 512.71}, {21, 576.32}, {22, 592.53}, {23, <br>
&nbsp; &nbsp; 607.17}, {24, 627.34}, {25, 635.67}, {26, 645.82}, {27, <br>
&nbsp; &nbsp; 674.27}, {28, 699.99}, {29, 726.21}, {30, 753.56}, {31, 786.17}};<br>
model = k/(1 + a*E^(-r*t))<br>
fit = FindFit[datapy, model, {k, a, r}, t]<br>
modelf = Function[{t}, Evaluate[model /. fit]]<br>
Plot[{modelf[t]}, {t, 0, 31}, Epilog -&gt; Map[Point, datapy]]<br>
得到的函数是 746.207/(1 + 91.4293 E^(-0.26602 t)) ，如图。<br>




<img src="attachments/1204301819e3d0aa382f2085b1.png" onclick="zoom(this, this.src)" id="aimg_213" alt="QQ截图20120430181516.png" width="421">

<div class="t_attach">
 (11.45 KB)<br>

<div class="t_smallfont">2012-4-30 18:19</div></div>

<br>
<br>
这样我们再平移回去，便得到原数据的拟合函数曲线 746.207/(1 + 91.4293 E^(-0.26602 (t - 1979))) ，作图如下。<br>
Plot[746.207/(1 + 91.4293 E^(-0.26602 (t - 1979))), {t, 1979, 2010}, <br>
 Epilog -&gt; Map[Point, data]]<br>




<img src="attachments/1204301822897779d2b9839d2b.png" onclick="zoom(this, this.src)" id="aimg_215" alt="QQ截图20120430182235.png" width="376">

<div class="t_attach">
 (6.49 KB)<br>

<div class="t_smallfont">2012-4-30 18:22</div></div>

<br>
<br>
注意到函数能左右平移，这是因为 $a\cdot e^{-r\cdot (t+c)} = (a\cdot e^{-rc})e^{-r\cdot t}$，所以 746.207/(1 + 91.4293 E^(-0.26602 (t - 1979))) 其实也可以变回原来要求的形式。<br>
于是当时我就奇怪了，既然该函数能左右平移，那为什么一开始不行，要移回来就行了呢？<br>
后来在 <a href="http://reference.wolfram.com/legacy/v7/ref/FindFit.html" target="_top">http://reference.wolfram.com/legacy/v7/ref/FindFit.html</a> 这里看到后面提到的“参数初始值”部分才知道原因所在。<br>
给定不同的参数初始值，可能会得到不同的拟合曲线，上面的情况就是默认的初始值搜索不到那个很好的拟合。<br>
但是初始值应该定在哪里，真不好说，我试过很多值都还是跟最开始差不多甚至出现了些不知什么意思的信息，直到利用上面的结果的近似值给出的初始值才勉强可以（还会弹出不知什么信息）<br>
data = {{1979, 0.15}, {1980, 1.2}, {1981, 3.3}, {1982, 9.5}, {1983, <br>
&nbsp; &nbsp; 19}, {1984, 30.61}, {1985, 40.29}, {1986, 42.11}, {1987, <br>
&nbsp; &nbsp; 49.84}, {1988, 60}, {1989, 76.78}, {1990, 99.13}, {1991, <br>
&nbsp; &nbsp; 153.54}, {1992, 187.8}, {1993, 248.28}, {1994, 318.74}, {1995, <br>
&nbsp; &nbsp; 349.99}, {1996, 379.51}, {1997, 418.29}, {1998, 465.73}, {1999, <br>
&nbsp; &nbsp; 512.71}, {2000, 576.32}, {2001, 592.53}, {2002, 607.17}, {2003, <br>
&nbsp; &nbsp; 627.34}, {2004, 635.67}, {2005, 645.82}, {2006, 674.27}, {2007, <br>
&nbsp; &nbsp; 699.99}, {2008, 726.21}, {2009, 753.56}, {2010, 786.17}};<br>
model = k/(1 + a*E^(-r*t));<br>
fit = FindFit[data, <br>
&nbsp;&nbsp;model, {{k, 746.2}, {a, 91.4293*E^(0.266*1979)}, {r, 0.266}}, t]<br>
modelf = Function[{t}, Evaluate[model /. fit]]<br>
Plot[{modelf[t]}, {t, 1979, 2010}, Epilog -&gt; Map[Point, data]]<br>




<img src="attachments/1204301832d5ce4ffe438dcbec.png" onclick="zoom(this, this.src)" id="aimg_214" alt="QQ截图20120430181641.png" width="524">

<div class="t_attach">
 (16.67 KB)<br>

<div class="t_smallfont">2012-4-30 18:32</div></div>

<br>
<br>
所以还是平移好了……<!--++ plugin_code qcomic begin-->
<!--++ plugin_code qcomic end--></td></tr></tbody></table>
</div>

<div id="post_rate_div_2454"></div>

                                                
                <div id="relate_subject" style="margin-top: 10px; width: 99%;"></div>
                
                

</div>

</div>

<div id="ad_thread1_0"></div><div class="signatures" style="">
<table cellpadding="0" cellspacing="0">
<tbody><tr>
<td>
基本信息：kuing，GG，19880618~?，地道广州人，高中毕业，无业游民，不等式爱好者，论坛混混；<br>
现状：冇钱又冇样、冇型又冇款、冇身材又冇文采、冇学历又冇能力、冇高度冇速度冇力度兼夹冇野做！（粤语）</td>
</tr>
</tbody></table>
</div>
</td>
</tr>
<tr>
<td class="postauthor"></td>
<td class="postcontent">

        <div class="postactions">
<div class="postact s_clear">
<em>


</em>
<p>


</p>
</div>
</div>
</td>
</tr>
<tr class="threadad">
<td class="postauthor"></td>
<td class="adcontent">
<div id="ad_interthread"></div></td>
</tr>
</tbody></table>

</div><div id="post_2455"><table id="pid2455" summary="pid2455" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="postauthor">
<div class="postinfo">
<a target="_top" href="#" style="margin-left: 20px; font-weight: 800;">kuing</a>

</div>
<div class="popupmenu_popup userinfopanel" id="userinfo2455" style="display: none; position: absolute; margin-top: -11px;">
<div class="popavatar">
<div id="userinfo2455_ma"></div>

</div>
<div class="popuserinfo">
<p>
kuing
<em>当前在线
</em>
</p>

<dl class="s_clear"><dt>UID</dt><dd>1&nbsp;</dd><dt>帖子</dt><dd>3992&nbsp;</dd><dt>精华</dt><dd>0&nbsp;</dd><dt>积分</dt><dd>25208&nbsp;</dd><dt>威望</dt><dd>6 &nbsp;</dd><dt>阅读权限</dt><dd>200&nbsp;</dd><dt>性别</dt><dd>男&nbsp;</dd><dt>来自</dt><dd>广东广州&nbsp;</dd><dt>在线时间</dt><dd>4648 小时&nbsp;</dd><dt>注册时间</dt><dd>2011-9-25&nbsp;</dd><dt>最后登录</dt><dd>2013-6-6&nbsp;</dd></dl>
<div class="imicons">

</div>
<div id="avatarfeed"><span id="threadsortswait"></span></div>
</div>
</div>
 <a name="lastpost"></a><div id="userinfo2455_a">
<div class="avatar" style="text-align: center; margin-left: 0px; margin-right: 0px;"><a href="#" target="_top"><img src="01_avatar_middle.jpg" onerror="this.onerror=null;this.src='none.gif'"></a></div>
<p><em>管理员</em></p>
</div>
<p></p>
<dl class="profile s_clear"><dt>UID</dt><dd>1&nbsp;</dd><dt>帖子</dt><dd>3992&nbsp;</dd></dl></td>
<td class="postcontent">
<div class="postinfo">
<div class="posterinfo">
                <strong><em>2</em><sup>#</sup></strong>
<div class="pagecontrol">
</div>
<div class="authorinfo">
<img class="authicon" id="authicon2455" src="online_admin.gif" onclick="showauthor(this, 'userinfo2455')">
<em id="authorposton2455">发表于 2012-4-30 18:37</em>


                </div>
</div>
</div>
<div class="defaultpost">
<div id="ad_thread2_1"></div>        <div id="ad_thread4_1"></div>
<div class="postmessage ">
<div class="t_msgfontfix">
                    <table style="width: 100%;" cellpadding="0" cellspacing="0">
                        <tbody><tr><td class="t_msgfont" id="postmessage_2455">
                                <div id="ad_thread3_1"></div>                                最后顺便计算一下 746.207/(1 + 91.4293 E^(-0.26602 (t - 1979))) 这个结果与原数据的标准差。<br>
asdf = Table[{t, 746.207/(1 + 91.4293 E^(-0.26602 (t - 1979)))}, {t, <br>
&nbsp; &nbsp;1979, 2010}]<br>
Sqrt[Total[(asdf - data)^2][[2]]/(2010 - 1979 + 1)]<br>
得到标准差为20.4331<!--++ plugin_code qcomic begin-->
<!--++ plugin_code qcomic end--></td></tr></tbody></table>
</div>

<div id="post_rate_div_2455"></div>

                </div>

</div>

<div id="ad_thread1_1"></div><div class="signatures" style="">
<table cellpadding="0" cellspacing="0">
<tbody><tr>
<td>
基本信息：kuing，GG，19880618~?，地道广州人，高中毕业，无业游民，不等式爱好者，论坛混混；<br>
现状：冇钱又冇样、冇型又冇款、冇身材又冇文采、冇学历又冇能力、冇高度冇速度冇力度兼夹冇野做！（粤语）</td>
</tr>
</tbody></table>
</div>
</td>
</tr>
<tr>
<td class="postauthor"></td>
<td class="postcontent">
        <div class="postactions">
<div class="postact s_clear">
<em>


</em>
<p>

</p>
</div>
</div>
</td>
</tr>
<tr class="threadad">
<td class="postauthor"></td>
<td class="adcontent">
</td>
</tr>
</tbody></table>
</div></div>

<div id="postlistreply" class="mainbox viewthread"><div id="post_new" style="display: none;"></div></div>




<div class="forumcontrol s_clear">
<table cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="modaction">
</td>
<td>
<span class="pageback"><a indepth="true" href="forum-20-1.html">返回列表</a></span>


</td>
</tr>
</tbody></table>
</div>



</div>






<div id="footer">
<div class="wrap s_clear">
<div id="footlink">

<p class="smalltext">
GMT+8, 2013-6-6 19:54.
</p>

</div>


	</div>
</div>

</body></html>
